@model TL4_SHOP.Models.ViewModels.DonHangDetailViewModel
@{
  ViewData["Title"] = "Chi tiết đơn hàng #" + Model.DonHangId;
  Layout = "~/Areas/Admin/Views/Shared/_Admin_Layout.cshtml";
  var statuses = (IEnumerable<TL4_SHOP.Data.TrangThaiDonHang>)ViewBag.Statuses;
}
<div class="d-flex align-items-center justify-content-between mb-3">
  <h4 class="mb-0">@ViewData["Title"]</h4>
  <div class="d-flex gap-2">
    <a class="btn btn-secondary" asp-action="Index">Quay lại</a>
    <a class="btn btn-outline-primary" asp-action="Invoice" asp-route-id="@Model.DonHangId">Xuất hoá đơn</a>
  </div>
</div>
<div class="card">
  <div class="card-body">
    <div class="row">
      <div class="col-lg-6">
        <h6 class="text-muted">Thông tin</h6>
        <p><strong>Khách hàng:</strong> @Model.TenKhachHang</p>
        <p><strong>Số điện thoại:</strong> @Model.SoDienThoai</p>
        <p><strong>Địa chỉ giao:</strong> @Model.DiaChiGiaoHang</p>
        <p><strong>Ngày đặt:</strong> @Model.NgayDatHang.ToString("dd/MM/yyyy HH:mm")</p>
        <p><strong>Tổng tiền:</strong> @Model.TongTien.ToString("N0") đ</p>
      </div>
      <div class="col-lg-6">
        <h6 class="text-muted">Trạng thái</h6>
        <form class="d-flex align-items-center gap-2" asp-action="UpdateStatus" method="post">
          @Html.AntiForgeryToken()
          <input type="hidden" name="id" value="@Model.DonHangId" />
                    <select class="form-select" name="statusId" style="max-width:320px">
                        @foreach (var s in statuses)
                        {
                            if (Model.TrangThai == s.TrangThaiId)
                            {
                                <option value="@s.TrangThaiId" selected>@s.TenTrangThai</option>
                            }
                            else
                            {
                                <option value="@s.TrangThaiId">@s.TenTrangThai</option>
                            }
                        }
                    </select>
          <button class="btn btn-primary">Cập nhật</button>
        </form>
      </div>
    </div>

    <hr />
    <div class="table-responsive">
      <table class="table table-striped align-middle">
        <thead>
          <tr>
            <th>ID</th>
            <th>Tên sản phẩm</th>
            <th class="text-center">SL</th>
            <th class="text-end">Đơn giá</th>
            <th class="text-end">Thành tiền</th>
          </tr>
        </thead>
        <tbody>
          @foreach (var i in Model.ChiTiet)
          {
            <tr>
              <td>@i.SanPhamId</td>
              <td>@i.TenSanPham</td>
              <td class="text-center">@i.SoLuong</td>
              <td class="text-end">@i.DonGia.ToString("N0") đ</td>
              <td class="text-end">@i.ThanhTien.ToString("N0") đ</td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
</div>